# Minimal tmux config for browser-multiplexer
# Hides all tmux UI and disables keybindings to make it invisible

# Disable status bar
set -g status off

# Disable all prefix key (effectively disables all tmux shortcuts)
set -g prefix None
unbind-key -a

# Enable mouse for scrollback (hold Shift to select text with native browser selection)
set -g mouse on

# Suppress right-click menu (prevent tmux menu from leaking to user)
unbind-key -T root MouseDown3Pane
unbind-key -T root MouseDown3Status
unbind-key -T root MouseDown3StatusLeft
unbind-key -T root MouseDown3StatusRight
unbind-key -T root MouseDown3StatusDefault
unbind-key -T root M-MouseDown3Pane

# Don't display any messages
set -g display-time 0

# Disable activity monitoring
set -g monitor-activity off
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
set -g bell-action none

# Large scrollback buffer for history preservation
set -g history-limit 50000

# Pass through all keys to the application
set -g escape-time 0

# Disable detach on destroy - just exit
set -g detach-on-destroy off

# Set terminal type
set -g default-terminal "xterm-256color"

# Use external clipboard mode: allows apps to send OSC 52 through to the terminal,
# but tmux won't set clipboard when copying in copy-mode (use shift+drag for that)
set -g set-clipboard external

# Allow applications to send OSC 52 through tmux (needed for neovim, opencode, etc.)
set -g allow-passthrough on

# Copy mode: simplified scrollback that exits on most keys
# Use vi mode as base, then customize
set -g mode-keys vi

# Clear all copy-mode-vi bindings first, then add only what we need
unbind-key -T copy-mode-vi -a

# Navigation keys that stay in copy mode
bind-key -T copy-mode-vi WheelUpPane send-keys -X scroll-up
bind-key -T copy-mode-vi WheelDownPane send-keys -X scroll-down
bind-key -T copy-mode-vi PageUp send-keys -X page-up
bind-key -T copy-mode-vi PageDown send-keys -X page-down
bind-key -T copy-mode-vi Up send-keys -X cursor-up
bind-key -T copy-mode-vi Down send-keys -X cursor-down
bind-key -T copy-mode-vi Home send-keys -X history-top
bind-key -T copy-mode-vi End send-keys -X history-bottom
bind-key -T copy-mode-vi C-Up send-keys -X scroll-up
bind-key -T copy-mode-vi C-Down send-keys -X scroll-down
bind-key -T copy-mode-vi S-Up send-keys -X scroll-up
bind-key -T copy-mode-vi S-Down send-keys -X scroll-down

# Mouse drag in copy mode - just cancel on release, don't copy to clipboard
# (use shift+drag for native browser selection that copies to system clipboard)
bind-key -T copy-mode-vi MouseDrag1Pane select-pane \; send-keys -X begin-selection
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X cancel

# Suppress right-click in copy mode
unbind-key -T copy-mode-vi MouseDown3Pane

# Keys that exit copy mode
bind-key -T copy-mode-vi Escape send-keys -X cancel
bind-key -T copy-mode-vi q send-keys -X cancel
bind-key -T copy-mode-vi Enter send-keys -X cancel
bind-key -T copy-mode-vi Space send-keys -X cancel
bind-key -T copy-mode-vi BSpace send-keys -X cancel
